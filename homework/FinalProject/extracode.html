countries.merge(enterCountries)
    .attr("fill", function(d) {
      var countryName = countryList[d.id];
      if (countryName) {
        var dataPoint = data.filter(function(a) {
          return a["Country name"] === countryName
        });

        if (dataPoint.length) {
          dataPoint = dataPoint[0];
          console.log("Found one!", dataPoint);
          return "green";
        }
        else {
          console.log("Missing Data", countryName);
          return "red";
        }

      }
      else {
        return "gray";
      }
      
    });



  var maximumLatter = d3.max(data, function(d) {
      return d.Life_Ladder;
    });

  var barColor = d3.scaleLinear()
    .domain([0, maximumLatter])
    .range(["yellow", "purple"]);
  
  countries.merge(enterCountries)
  .attr("fill", function(d) {
    var countryName = countryList[d.id];
    if (countryName) {
      var dataPoint = data.filter(function(a) {
        return a["Country name"] === countryName
    });
  .attr("fill", function(d) {
      return barColor(d.Life_Ladder);
    })
  

  countries.merge(enterCountries)
    .attr("fill", function(d) {
      var countryName = countryList[d.id];
      if (countryName) {
        var dataPoint = data.filter(function(a) {
          return a["Country name"] === countryName
        })
      .style("fill", function(d) {
          return color(rateById[d.LifeLadder]);

    });

    countries.merge(enterCountries)
    .attr("fill", function(d) {
      return barColor(d.Life_Ladder);
    })


    var margin = {
      top: 20,
      right: 100,
      bottom: 100,
      left: 40
    };

      var chartWidth = width - margin.left - margin.right;
      var chartHeight = height - margin.top - margin.bottom;

      var scaleWidth = 300;
      var scaleHeight = 20;
      var scaleX = margin.left + chartWidth / 2 - scaleWidth / 2;
      var scaleY = margin.top + chartHeight + 40;

      var scale = svg.select("#scale")
        .attr("transform", "translate(" + scaleX + ", " + scaleY + ")");
    
      scale.select("#scaleRect")
      .attr("width", scaleWidth)
      .attr("height", scaleHeight);

      var stopsData = d3.range(0, 8, 1);

      svg.select("#colorGradient").selectAll("stop")
            .data(stopsData).enter()
            .append("stop")
              .attr("offset", function(d) {
                return d * 100 + "%";
              })
              .attr("stop-color", function(d) {
                return Color(d * maximumLatter);
              });

              <g id="map"></g>
            <rect x="800px" width="200px" height="25px" fill = "interpolators" />

            <script>
              var scaleWidth = 200;
              var scaleHeight = 25;
              
            var svg = d3.select("#legend")
              .attr("width", "200px")
              .attr("height", "25px" );
      
              var scale = svg.select("#scale");
      
              scale.select("#scaleRect")
              .attr("width", scaleWidth)
              .attr("height", scaleHeight);
      
            var interpolators = [
            "Viridis",
            "Inferno",
            "Magma",
            "Plasma",
            "Warm",
            "Cool",
            "Rainbow",
            "CubehelixDefault",
            "Blues",
            "Greens",
            "Greys",
            "Oranges",
            "Purples",
            "Reds",
            "BuGn",
            "BuPu",
            "GnBu",
            "OrRd",
            "PuBuGn",
            "PuBu",
            "PuRd",
            "RdPu",
            "YlGnBu",
            "YlGn",
            "YlOrBr",
            "YlOrRd"
          ];
        
        
          var colorGradient = d3.scaleSequential(d3.interpolateInferno)
          .domain([0, 8]);
      
                var stopsData = d3.range(0, 8, 1);
      
                svg.select("#colorGradient").selectAll("stop")
                  .data(stopsData).enter()
                  .append("stop")
                    .attr("offset", function(d) {
                      return d * 100 + "%";
                    })
                    .attr("stop-color", function(d) {
                      return colorGradient(d * 8);
                    });
      
                var scaleX = d3.scaleLinear()
                    .domain([0, 8]);
      
                var scaleAxis = d3.axisBottom(scaleX);
      
                scale.select("#scaleAxis")
                      .call(scaleAxis);
            </script>
      
      
            <div id="tooltip">
              <h2 id="title"></h2>
              Value: <span id="LifeLadder"></span>
            </div>
      
            <script src="./banner.js"></script>
            <script src="./map.js"></script>
            <script src="./button1.js"></script>
            <script src="./button2.js"></script>
            <script src="./button3.js"></script>
            <script src="./button4.js"></script>
            
          
            <script>
          
              var width = 1200;
              var height = 700;
        
              var svg = d3.select("#viz")
                .attr("width", width)
                .attr("height", height);
        
              d3.select("#ocean")
                .attr("width", width)
                .attr("height", height);
        
              var map = svg.select("#map");
      
              d3.queue()
                .defer(d3.json, "world-alpha2.json")
                .defer(d3.csv, "Data_WorldHappiness.csv")
                .awaitAll(function(error, response) {
                  var world = response[0];
                  var data = response[1];
      
                  console.log(data);
                  data.forEach(function(d) {
                    d["Generosity"] = parseFloat(d["Generosity"]);
                    d["year"] = parseFloat(d["year"]);
                    d["Life_Ladder"] = parseFloat(d["Life_Ladder"]);
                    d["Social_support"] = parseFloat(d["Social_support"]);
                    d["Healthy_life_expectancy_at_birth"] = parseFloat(d["Healthy_life_expectancy_at_birth"]);
                    d["Freedom_to_make_life_choices"] = parseFloat(d["Freedom_to_make_life_choices"]);
                  });
      
                  var currentYear = d3.max(data, function(d) {
                    return d.year;
                  });
      
                  function update(selectedYear) {
      
                    var currentData = data.filter(function(d) {
                      return d.year === selectedYear;
                    });
      
                    drawMap(world, currentData, "Generosity");
                  }
      
                  update(currentYear);
      
                  d3.selectAll(".dropdown-button")
                    .on("click", function() {
                      var year = parseFloat(this.innerText);
                      update(year);
                    });
      
                });
        
            </script>

