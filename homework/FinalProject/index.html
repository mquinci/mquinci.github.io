<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <title>World Happiness Over Time</title>
    <link rel="stylesheet" href="./styles.css" />
    <link href='https://fonts.googleapis.com/css?family=Happy Monkey' rel='stylesheet'>
    <link rel="stylesheet/less" type="text/css" href="styles.less" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">  
    <defs>
      <linearGradient id="colorGradient">
        <stop offset="0%" stop-color="yellow" />
        <stop offset="100%" stop-color="purple" />
      </linearGradient>
    </defs>
  </head>
  <body style="background-color:rgb(241, 206, 129);">

    <div id="banner">
        <h1>How has world happiness changed over time?</h1>
    </div>
      <div class="section">
        <p>Every year, the Sustainable Development Solutions Network publishes a World Happiness Report that examines how “happy” the people living in a given country are. These “happiness scores” are viewed in the context of 6 factors: Logged GDP per capita, Social support, Healthy life expectancy, Freedom to make life choices, Generosity, and Perception of corruption. This project will focus no happiness trends from 2015-2020 through the lens of social support, healthy life expectancy, and freedom to make life choices. 
          <br><br>How can this information inform how we evaluate happiness in our lives?
        </p>
      </div>
        <div>
          <div class="row">
            <button class="column button4" id="button1" onclick="myFunction()">Happiness Score</button>
            <button class="column button4" id="button2" onclick="myFunction()">Healthy Life <br />Expectancy</button>
          </div>
          <div class="row">
            <button class="column button4" id="button3" onclick="myFunction()">Social Support</button>
            <button class="column button4" id="button4" onclick="myFunction()">Freedom to Make<br> Life Choices</button>
          </div>
        </div>
      <div>
        <svg height="1000px" width="1500px" id="viz">
          <defs>
            <linearGradient id="colorGradient">
            </linearGradient>
          </defs>
          <rect id="ocean" x="0" y="0" fill="cornflowerblue" />
          <g id="map"></g>
        </svg>
      </div>
      <div class="section1">
        <div class="dropdown">
          <button class="dropbtn">Select a year</button>
          <div class="dropdown-content">
            <a href="#">2015</a>
            <a href="#">2016</a>
            <a href="#">2017</a>
            <a href="#">2018</a>
            <a href="#">2019</a>
            <a href="#" onclick="update(csv2020)">2020</a>
          </div>
          <script src="button5.js" type="text/javascript"></script>
        </div>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In sem lacus, molestie sit amet massa sit amet, posuere egestas tellus. Maecenas et nulla eget sapien fermentum pharetra. Nam nec ipsum quis nisi aliquet convallis. Vestibulum quis sagittis nisi. Fusce pulvinar efficitur elementum.</p>
      </div>
      <div class = "section">
        <svg class = "section"></svg>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque ut enim sit amet turpis elementum tristique at in mauris. Etiam egestas nulla vel leo dictum eleifend. Aenean ac gravida leo. Phasellus sed justo rutrum, iaculis orci vel, fringilla nisi. Pellentesque vestibulum aliquam odio, sed suscipit metus aliquet rutrum. Nam pharetra et nibh a semper. Phasellus a eleifend magna. Nulla vel sapien vulputate, finibus justo ac, convallis odio. Nulla et augue arcu. Duis porta augue laoreet lacus dictum, eu hendrerit sem tempor. Integer condimentum, enim sit amet sollicitudin pretium, ligula leo convallis nibh, eget aliquam ex orci vitae quam. Morbi maximus.</p>
      </div>


      <div id="tooltip">
        <h2 id="title"></h2>
        Value: <span id="value"></span>
      </div>

      <script src="./banner.js"></script>
      <script src="./map.js"></script>
      <script src="./button1.js"></script>
      <script src="./button2.js"></script>
      <script src="./button3.js"></script>
      <script src="./button4.js"></script>
      
    
      <script>
    
        var width = 1200;
        var height = 700;
  
        var svg = d3.select("#viz")
          .attr("width", width)
          .attr("height", height);
  
        d3.select("#ocean")
          .attr("width", width)
          .attr("height", height);
  
        var map = svg.select("#map");

        d3.queue()
          .defer(d3.json, "world-alpha2.json")
          .defer(d3.csv, "Data_WorldHappiness.csv")
          .awaitAll(function(error, response) {
            var world = response[0];
            var data = response[1];

            console.log(data);
            data.forEach(function(d) {
              d["Generosity"] = parseFloat(d["Generosity"]);
              d["year"] = parseFloat(d["year"]);
              d["Life_Ladder"] = parseFloat(d["Life_Ladder"]);
              d["Social_support"] = parseFloat(d["Social_support"]);
              d["Healthy_life_expectancy_at_birth"] = parseFloat(d["Healthy_life_expectancy_at_birth"]);
              d["Freedom_to_make_life_choices"] = parseFloat(d["Freedom_to_make_life_choices"]);
            });

            //Filter out just 2020 data
            d3.csv("Data_WorldHappiness.csv", function(csv) {
              csv2020 = csv.filter(function(row) {
              return row['year'] == '2020';
              });
            console.log(csv2020);
});

            var currentYear = 2019;

            var currentData = data.filter(function(d) {
              return d.year === currentYear;
            })

            drawMap(world, currentData, "Generosity");

          });
  
      </script>

  </body>
</html>