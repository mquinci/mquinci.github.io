<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <title>World Happiness Over Time</title>
    <link rel="stylesheet" href="./styles.css" />
    <link href='https://fonts.googleapis.com/css?family=Happy Monkey' rel='stylesheet'>
    <link rel="stylesheet/less" type="text/css" href="styles.less" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">  
  </head>
  <body style="background-color:rgb(243, 225, 186);">


    <div id="banner">
        <h1>How has world happiness changed over time?</h1>
    </div>
      <div class="section">
        <p>Every year, the Sustainable Development Solutions Network publishes a World Happiness Report that examines how “happy” the people living in a given country are. These “happiness scores” are viewed in the context of 6 factors: Logged GDP per capita, Social support, Healthy life expectancy, Freedom to make life choices, Generosity, and Perception of corruption. This project will focus no happiness trends from 2015-2020 through the lens of social support, healthy life expectancy, and freedom to make life choices. 
          <br><br>How can this information inform how we evaluate happiness in our lives?
        </p>
      </div>
        <div>
          <div class="row">
            <button class="column button4" id="button1" onclick="myFunction()">Happiness Score</button>
            <button class="column button4" id="button2" onclick="myFunction()">Healthy Life Expectancy</button>
          </div>
          <div class="row">
            <button class="column button4" id="button3" onclick="myFunction()">Social Support</button>
            <button class="column button4" id="button4" onclick="myFunction()">Freedom to Make Life Choices</button>
          </div>
        </div>
      <div>
        <svg height="700px" width="1000px" id="viz">
          <defs>
          </defs>
          <rect id="ocean" x="0" y="0" fill="#D8E4FA" />
          <g id="map"></g>
        </svg>
      </div>
      <div>
      <div>
     <div class="section1">
      <div class="dropdown">
          <button class="dropbtn">Select a year</button>
          <div class="dropdown-content">
            <div class="dropdown-button">2015</div>
            <div class="dropdown-button">2016</div>
            <div class="dropdown-button">2017</div>
            <div class="dropdown-button">2018</div>
            <div class="dropdown-button">2019</div>
            <div class="dropdown-button">2020</div>
          </div>
          <svg id = legend height="25px" width="1000px">
            <defs>
              <linearGradient id="colorGradient">
              </linearGradient>
            </defs>
            <g>
              <rect id="map" x="800px" width="200px" height="25px" fill="url(#colorGradient)" stroke="black" />
              <g id="scaleAxis"></g>
            </g>
          </svg>
          <script> 
            var width = 1005, height = 50; 
            var svg = d3.select("body") 
                .append("svg") 
                .attr("width", width) 
                .attr("height", height); 
      
            var xscale = d3.scaleLinear() 
                .domain([0, 10]) 
                .range([0, width - 810]); 
      
            var scaleAxis = d3.axisBottom().scale(xscale); 
      
            var xAxisTranslate = height / 2; 
      
            svg.append("g") 
                .attr("transform", "translate(800, " 
                + xAxisTranslate + ")") 
                .call(scaleAxis) 

                var stopsData = d3.range(0, 8, 1);
      
      svg.select("#colorGradient").selectAll("stop")
        .data(stopsData).enter()
        .append("stop")
          .attr("offset", function(d) {
            return d * 100 + "%";
          })
          .attr("stop-color", function(d) {
            return colorGradient(d * 8);
          });

      var scaleX = d3.scaleLinear()
          .domain([0, 8]);

      var scaleAxis = d3.axisBottom(scaleX);

      scale.select("#scaleAxis")
            .call(scaleAxis);
  </script>
        </script>
      </div>
    </div>
    </div>
  </div>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In sem lacus, molestie sit amet massa sit amet, posuere egestas tellus. Maecenas et nulla eget sapien fermentum pharetra. Nam nec ipsum quis nisi aliquet convallis. Vestibulum quis sagittis nisi. Fusce pulvinar efficitur elementum.</p>
        


      <div id="tooltip">
        <h2 id="title"></h2>
        Value: <span id="LifeLadder"></span>
      </div>

      <script src="./banner.js"></script>
      <script src="./map.js"></script>
      <script src="./button1.js"></script>
      <script src="./button2.js"></script>
      <script src="./button3.js"></script>
      <script src="./button4.js"></script>
      
    
      <script>
    
        var width = 1200;
        var height = 700;
  
        var svg = d3.select("#viz")
          .attr("width", width)
          .attr("height", height);
  
        d3.select("#ocean")
          .attr("width", width)
          .attr("height", height);
  
        var map = svg.select("#map");

        d3.queue()
          .defer(d3.json, "world-alpha2.json")
          .defer(d3.csv, "Data_WorldHappiness.csv")
          .awaitAll(function(error, response) {
            var world = response[0];
            var data = response[1];

            console.log(data);
            data.forEach(function(d) {
              d["Generosity"] = parseFloat(d["Generosity"]);
              d["year"] = parseFloat(d["year"]);
              d["Life_Ladder"] = parseFloat(d["Life_Ladder"]);
              d["Social_support"] = parseFloat(d["Social_support"]);
              d["Healthy_life_expectancy_at_birth"] = parseFloat(d["Healthy_life_expectancy_at_birth"]);
              d["Freedom_to_make_life_choices"] = parseFloat(d["Freedom_to_make_life_choices"]);
            });

            var currentYear = d3.max(data, function(d) {
              return d.year;
            });

            function update(selectedYear) {

              var currentData = data.filter(function(d) {
                return d.year === selectedYear;
              });

              drawMap(world, currentData, "Generosity");
            }

            update(currentYear);

            d3.selectAll(".dropdown-button")
              .on("click", function() {
                var year = parseFloat(this.innerText);
                update(year);
              });

          });
  
      </script>

  </body>
</html>